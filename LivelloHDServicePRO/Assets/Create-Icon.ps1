# Script per creare un'icona placeholder per Livello HD Service PRO
# Questo crea un'icona semplice da usare temporaneamente

Write-Host "?????????????????????????????????????????????????????????" -ForegroundColor Cyan
Write-Host "?  Creazione Icona Placeholder - Livello HD Service    ?" -ForegroundColor Cyan
Write-Host "?????????????????????????????????????????????????????????" -ForegroundColor Cyan
Write-Host ""

$iconPath = "..\LivelloHDServicePRO\Assets\app-icon.ico"

# Verifica se l'icona esiste già
if (Test-Path $iconPath) {
    Write-Host "? Icona già esistente: $iconPath" -ForegroundColor Green
    Write-Host ""
    $replace = Read-Host "Vuoi sostituirla? (s/n)"
    if ($replace -ne "s") {
        Write-Host "Operazione annullata." -ForegroundColor Yellow
        Read-Host "Premi ENTER per uscire"
        exit 0
    }
}

Write-Host ""
Write-Host "??  NOTA IMPORTANTE" -ForegroundColor Yellow
Write-Host "???????????????????" -ForegroundColor Yellow
Write-Host "PowerShell non può creare file .ico nativamente." -ForegroundColor White
Write-Host "Per creare l'icona, hai 3 opzioni:" -ForegroundColor White
Write-Host ""

Write-Host "OPZIONE 1: Convertitore Online (Raccomandato)" -ForegroundColor Cyan
Write-Host "???????????????????????????????????????????????" -ForegroundColor Gray
Write-Host "1. Vai su: https://www.icoconverter.com" -ForegroundColor White
Write-Host "2. Carica un'immagine PNG o JPG (es: logo aziendale)" -ForegroundColor White
Write-Host "3. Seleziona dimensioni multiple (16, 32, 48, 256)" -ForegroundColor White
Write-Host "4. Scarica il file .ico" -ForegroundColor White
Write-Host "5. Salvalo come: $iconPath" -ForegroundColor White
Write-Host ""

Write-Host "OPZIONE 2: Usare un'icona di esempio" -ForegroundColor Cyan
Write-Host "?????????????????????????????????????" -ForegroundColor Gray
Write-Host "1. Cerca 'business analytics icon' su www.flaticon.com" -ForegroundColor White
Write-Host "2. Scarica in formato ICO (se disponibile)" -ForegroundColor White
Write-Host "3. Oppure scarica PNG e convertilo con Opzione 1" -ForegroundColor White
Write-Host ""

Write-Host "OPZIONE 3: Estrarre da file Windows" -ForegroundColor Cyan
Write-Host "????????????????????????????????????" -ForegroundColor Gray
Write-Host "1. Usa IconsExtract (NirSoft): https://www.nirsoft.net/utils/iconsext.html" -ForegroundColor White
Write-Host "2. Estrai un'icona da shell32.dll o imageres.dll" -ForegroundColor White
Write-Host "3. Icone suggerite: Business, Charts, Documents" -ForegroundColor White
Write-Host ""

Write-Host "???????????????????????????????????????????????????????" -ForegroundColor Cyan
Write-Host ""

$choice = Read-Host "Vuoi aprire il convertitore online? (s/n)"

if ($choice -eq "s") {
    Write-Host "Apertura browser..." -ForegroundColor Green
    Start-Process "https://www.icoconverter.com"
    Write-Host ""
    Write-Host "Dopo aver creato l'icona:" -ForegroundColor Yellow
    Write-Host "1. Salvala come: app-icon.ico" -ForegroundColor White
    Write-Host "2. Copiala in: LivelloHDServicePRO\Assets\" -ForegroundColor White
    Write-Host "3. Ricompila il progetto" -ForegroundColor White
}

Write-Host ""
Write-Host "???????????????????????????????????????????????????????" -ForegroundColor Green
Write-Host "  ICONA GIÀ CONFIGURATA NEL PROGETTO!                  " -ForegroundColor Green
Write-Host "???????????????????????????????????????????????????????" -ForegroundColor Green
Write-Host ""
Write-Host "Quando avrai l'icona:" -ForegroundColor Cyan
Write-Host "1. Copiala in: LivelloHDServicePRO\Assets\app-icon.ico" -ForegroundColor White
Write-Host "2. Ricompila il progetto (Ctrl+Shift+B)" -ForegroundColor White
Write-Host "3. L'icona apparirà automaticamente!" -ForegroundColor White
Write-Host ""
Write-Host "Configurazione presente in:" -ForegroundColor Gray
Write-Host "  ? MainWindow.xaml ? Icon='Assets/app-icon.ico'" -ForegroundColor Gray
Write-Host "  ? .csproj ? ApplicationIcon" -ForegroundColor Gray
Write-Host "  ? Setup .iss ? SetupIconFile (quando decommentato)" -ForegroundColor Gray
Write-Host ""

Read-Host "Premi ENTER per uscire"
